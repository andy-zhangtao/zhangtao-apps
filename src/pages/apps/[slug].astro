---
import { getCollection, getEntry } from 'astro:content';
import Layout from '../../components/Layout.astro';

export async function getStaticPaths() {
  const apps = await getCollection('apps');
  return apps.map(app => ({
    params: { slug: app.slug },
  }));
}

const { slug } = Astro.params;
const app = await getEntry('apps', slug);

if (!app) {
  return Astro.redirect('/404');
}

const { Content } = await app.render();

const categoryConfig = {
  mobile: { label: 'ç§»åŠ¨åº”ç”¨', color: 'from-green-400 to-emerald-500', icon: 'ğŸ“±', bg: 'bg-green-50' },
  desktop: { label: 'æ¡Œé¢åº”ç”¨', color: 'from-blue-400 to-cyan-500', icon: 'ğŸ’»', bg: 'bg-blue-50' },
  web: { label: 'Webåº”ç”¨', color: 'from-purple-400 to-pink-500', icon: 'ğŸŒ', bg: 'bg-purple-50' },
  cli: { label: 'å‘½ä»¤è¡Œå·¥å…·', color: 'from-gray-400 to-slate-500', icon: 'âŒ¨ï¸', bg: 'bg-gray-50' }
};

const statusConfig = {
  published: { label: 'âœ¨ å·²å‘å¸ƒ', color: 'from-green-400 to-green-600', pulse: 'animate-pulse' },
  beta: { label: 'ğŸš§ Betaç‰ˆ', color: 'from-yellow-400 to-orange-500', pulse: '' },
  development: { label: 'ğŸ”¥ å¼€å‘ä¸­', color: 'from-blue-400 to-indigo-600', pulse: 'animate-pulse' },
  archived: { label: 'ğŸ“¦ å·²å½’æ¡£', color: 'from-gray-400 to-gray-600', pulse: '' }
};
---

<Layout title={`${app.data.title} - App Showcase`}>
  <!-- èƒŒæ™¯åŠ¨ç”» -->
  <div class="fixed inset-0 -z-10">
    <div class="absolute inset-0 bg-gradient-to-br from-violet-100 via-sky-50 to-cyan-100"></div>
    <div class="absolute top-0 -left-4 w-72 h-72 bg-purple-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"></div>
    <div class="absolute top-0 -right-4 w-72 h-72 bg-yellow-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"></div>
    <div class="absolute -bottom-8 left-20 w-72 h-72 bg-pink-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"></div>
  </div>

  <main class="min-h-screen">
    <div class="container mx-auto px-4 py-8">
      <!-- è¿”å›æŒ‰é’® - ç°ä»£ç»ç’ƒæ€æ•ˆæœ -->
      <div class="mb-8">
        <a 
          href="/" 
          class="group inline-flex items-center px-6 py-3 bg-white/20 backdrop-blur-lg border border-white/30 rounded-2xl text-gray-700 hover:bg-white/30 transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105"
        >
          <svg class="w-5 h-5 mr-2 transition-transform group-hover:-translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          <span class="font-medium">è¿”å›é¦–é¡µ</span>
        </a>
      </div>

      <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
      <div class="max-w-6xl mx-auto">
        <!-- HeroåŒºåŸŸ - å¤§èƒ†ç°ä»£è®¾è®¡ -->
        <section class="relative mb-12 overflow-hidden">
          <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-3xl p-8 md:p-12 shadow-2xl">
            <!-- è£…é¥°æ€§å…ƒç´  -->
            <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-pink-400/20 to-purple-600/20 rounded-full blur-3xl"></div>
            <div class="absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-blue-400/20 to-cyan-600/20 rounded-full blur-2xl"></div>
            
            <div class="relative grid md:grid-cols-3 gap-8 items-center">
              <!-- åº”ç”¨å›¾æ ‡ - ç°ä»£3Dæ•ˆæœ -->
              <div class="md:col-span-1 flex justify-center md:justify-start">
                <div class="relative group">
                  {app.data.icon ? (
                    <img 
                      src={app.data.icon} 
                      alt={`${app.data.title} icon`} 
                      class="w-32 h-32 rounded-3xl shadow-2xl transform group-hover:scale-110 group-hover:rotate-3 transition-all duration-500"
                    />
                  ) : (
                    <div class={`w-32 h-32 bg-gradient-to-br ${categoryConfig[app.data.category].color} rounded-3xl flex items-center justify-center text-white text-5xl font-bold shadow-2xl transform group-hover:scale-110 group-hover:rotate-3 transition-all duration-500`}>
                      {app.data.title.charAt(0)}
                    </div>
                  )}
                  <!-- å‘å…‰æ•ˆæœ -->
                  <div class={`absolute inset-0 bg-gradient-to-br ${categoryConfig[app.data.category].color} rounded-3xl blur-xl opacity-30 group-hover:opacity-50 transition-opacity duration-500 -z-10`}></div>
                </div>
              </div>

              <!-- åº”ç”¨ä¿¡æ¯ -->
              <div class="md:col-span-2 text-center md:text-left">
                <div class="flex flex-wrap justify-center md:justify-start items-center gap-4 mb-6">
                  <h1 class="text-5xl md:text-6xl font-black bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 bg-clip-text text-transparent leading-tight">
                    {app.data.title}
                  </h1>
                  {app.data.featured && (
                    <div class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold rounded-2xl shadow-lg animate-pulse">
                      â­ FEATURED
                    </div>
                  )}
                </div>

                <p class="text-xl md:text-2xl text-gray-600 mb-8 leading-relaxed font-light">
                  {app.data.description}
                </p>

                <!-- çŠ¶æ€å’Œåˆ†ç±»æ ‡ç­¾ - ç°ä»£èƒ¶å›Šè®¾è®¡ -->
                <div class="flex flex-wrap justify-center md:justify-start gap-4 mb-8">
                  <div class={`inline-flex items-center px-6 py-3 bg-gradient-to-r ${statusConfig[app.data.status].color} text-white font-bold rounded-2xl shadow-lg ${statusConfig[app.data.status].pulse}`}>
                    {statusConfig[app.data.status].label}
                  </div>
                  <div class={`inline-flex items-center px-6 py-3 bg-gradient-to-r ${categoryConfig[app.data.category].color} text-white font-semibold rounded-2xl shadow-lg`}>
                    <span class="mr-2 text-lg">{categoryConfig[app.data.category].icon}</span>
                    {categoryConfig[app.data.category].label}
                  </div>
                  <div class="inline-flex items-center px-6 py-3 bg-white/20 backdrop-blur-lg border border-white/30 rounded-2xl text-gray-700 font-medium">
                    ğŸ“… {app.data.publishDate.toLocaleDateString('zh-CN')}
                  </div>
                </div>

                <!-- CTAæŒ‰é’®ç»„ - ç°ä»£ç»ç’ƒæ€ -->
                <div class="flex flex-wrap justify-center md:justify-start gap-4">
                  {app.data.github && (
                    <a 
                      href={app.data.github} 
                      target="_blank" 
                      rel="noopener noreferrer"
                      class="group inline-flex items-center px-8 py-4 bg-gradient-to-r from-gray-900 to-black text-white font-bold rounded-2xl shadow-xl hover:shadow-2xl hover:scale-105 transition-all duration-300"
                    >
                      <svg class="w-6 h-6 mr-3 group-hover:rotate-12 transition-transform" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 0C4.477 0 0 4.484 0 10.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0110 4.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.942.359.31.678.921.678 1.856 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0020 10.017C20 4.484 15.522 0 10 0z" clip-rule="evenodd"></path>
                      </svg>
                      æŸ¥çœ‹æºç 
                    </a>
                  )}
                  {app.data.website && app.data.website !== '' && (
                    <a 
                      href={app.data.website} 
                      target="_blank" 
                      rel="noopener noreferrer"
                      class="group inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold rounded-2xl shadow-xl hover:shadow-2xl hover:scale-105 transition-all duration-300"
                    >
                      <span class="mr-3 text-xl group-hover:scale-110 transition-transform">ğŸŒ</span>
                      å®˜æ–¹ç½‘ç«™
                    </a>
                  )}
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- æŠ€æœ¯æ ˆå±•ç¤º - ç°ä»£å¡ç‰‡ç½‘æ ¼ -->
        <section class="mb-12">
          <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-3xl p-8 shadow-2xl">
            <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">
              ğŸ”§ æŠ€æœ¯æ ˆ
            </h2>
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
              {app.data.tech.map((tech, index) => (
                <div 
                  class="group relative overflow-hidden bg-white/20 backdrop-blur-lg border border-white/30 rounded-2xl p-4 text-center hover:bg-white/30 hover:scale-105 transition-all duration-300 shadow-lg"
                  style={`animation-delay: ${index * 100}ms`}
                >
                  <div class="text-sm font-semibold text-gray-800 group-hover:text-gray-900 transition-colors">
                    {tech}
                  </div>
                  <!-- æ‚¬æµ®å‘å…‰æ•ˆæœ -->
                  <div class="absolute inset-0 bg-gradient-to-r from-blue-400/0 via-purple-400/0 to-pink-400/0 group-hover:from-blue-400/10 group-hover:via-purple-400/10 group-hover:to-pink-400/10 rounded-2xl transition-all duration-300"></div>
                </div>
              ))}
            </div>
          </div>
        </section>

        <!-- è¯¦ç»†å†…å®¹ - ç°ä»£é˜…è¯»ä½“éªŒ -->
        <section class="mb-12">
          <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-3xl p-8 md:p-12 shadow-2xl">
            <div class="prose prose-lg max-w-4xl mx-auto text-gray-800">
              <Content />
            </div>
          </div>
        </section>

        <!-- æˆªå›¾å±•ç¤º - ç°ä»£ç”»å»Š -->
        {app.data.screenshots && app.data.screenshots.length > 0 && (
          <section class="mb-12">
            <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-3xl p-8 shadow-2xl">
              <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">
                ğŸ“¸ åº”ç”¨æˆªå›¾
              </h2>
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {app.data.screenshots.map((screenshot, index) => (
                  <div class="group relative overflow-hidden rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-500 hover:scale-105">
                    <img 
                      src={screenshot} 
                      alt={`${app.data.title} æˆªå›¾ ${index + 1}`}
                      class="w-full h-auto object-cover group-hover:scale-110 transition-transform duration-700"
                    />
                    <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                  </div>
                ))}
              </div>
            </div>
          </section>
        )}
      </div>
    </div>
  </main>
</Layout>

<style>
  /* åŠ¨ç”»å®šä¹‰ */
  @keyframes blob {
    0% { transform: translate(0px, 0px) scale(1); }
    33% { transform: translate(30px, -50px) scale(1.1); }
    66% { transform: translate(-20px, 20px) scale(0.9); }
    100% { transform: translate(0px, 0px) scale(1); }
  }

  .animate-blob {
    animation: blob 7s infinite;
  }

  .animation-delay-2000 {
    animation-delay: 2s;
  }

  .animation-delay-4000 {
    animation-delay: 4s;
  }

  /* ç°ä»£åŒ– prose æ ·å¼ - æè‡´èˆ’é€‚çš„é˜…è¯»ä½“éªŒ */
  .prose h1 {
    @apply text-4xl font-black bg-gradient-to-r from-gray-900 via-blue-800 to-gray-900 bg-clip-text text-transparent;
    line-height: 1.2;
    margin-top: 0;
    margin-bottom: 3rem;
    padding-bottom: 1.5rem;
    border-bottom: 3px solid #e5e7eb;
    position: relative;
  }

  .prose h1::after {
    content: '';
    position: absolute;
    bottom: -3px;
    left: 0;
    width: 60px;
    height: 3px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6);
    border-radius: 2px;
  }
  
  .prose h2 {
    @apply text-3xl font-bold text-gray-900 relative;
    margin-top: 5rem;
    margin-bottom: 2.5rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #f3f4f6;
    line-height: 1.3;
  }
  
  .prose h2::before {
    content: '';
    @apply absolute -left-6 top-1/2 w-3 h-10 bg-gradient-to-b from-blue-500 to-purple-600 rounded-full transform -translate-y-1/2;
  }

  .prose h2::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 40px;
    height: 2px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6);
    border-radius: 1px;
  }
  
  .prose h3 {
    @apply text-2xl font-bold text-gray-800 relative;
    margin-top: 3rem;
    margin-bottom: 1.8rem;
    line-height: 1.4;
    padding-left: 1rem;
  }

  .prose h3::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    width: 4px;
    height: 24px;
    background: linear-gradient(180deg, #60a5fa, #c084fc);
    border-radius: 2px;
    transform: translateY(-50%);
  }
  
  .prose p {
    @apply text-gray-700 text-lg;
    line-height: 1.9;
    margin-bottom: 2rem;
    text-align: justify;
    text-justify: inter-character;
    letter-spacing: 0.02em;
  }

  .prose p:first-of-type {
    font-size: 1.2rem;
    color: #374151;
    font-weight: 500;
    margin-bottom: 2.5rem;
  }
  
  .prose p + p {
    margin-top: 1.5rem;
  }

  /* ç‰¹åˆ«å¤„ç†ç²—ä½“æ®µè½ */
  .prose p strong:only-child {
    display: block;
    font-size: 1.1rem;
    color: #1f2937;
    margin-bottom: 0.5rem;
  }
  
  .prose ul {
    margin-top: 2rem;
    margin-bottom: 2.5rem;
    padding-left: 0;
  }
  
  .prose li {
    @apply text-gray-700 relative text-lg;
    line-height: 1.8;
    margin-bottom: 1.2rem;
    padding-left: 2rem;
    padding-top: 0.2rem;
    padding-bottom: 0.2rem;
  }
  
  .prose li::before {
    content: 'â–¶';
    @apply absolute left-0 text-blue-500 font-bold;
    top: 0.3rem;
    font-size: 0.9rem;
  }

  /* æœ‰åºåˆ—è¡¨æ ·å¼ */
  .prose ol {
    margin-top: 2rem;
    margin-bottom: 2.5rem;
    padding-left: 0;
    counter-reset: list-counter;
  }

  .prose ol li {
    counter-increment: list-counter;
    padding-left: 2.5rem;
  }

  .prose ol li::before {
    content: counter(list-counter);
    @apply absolute left-0 top-0 w-6 h-6 bg-gradient-to-br from-blue-500 to-purple-600 text-white text-sm font-bold rounded-full flex items-center justify-center;
  }
  
  .prose strong {
    @apply font-semibold bg-gradient-to-r from-blue-700 to-purple-700 bg-clip-text text-transparent;
    letter-spacing: 0.01em;
  }
  
  .prose code {
    @apply bg-gradient-to-r from-blue-50 to-purple-50 px-3 py-1.5 rounded-lg text-sm font-mono border border-blue-200;
    color: #4338ca;
    font-weight: 500;
  }

  /* å†…å®¹åŒºå—æ ·å¼ */
  .prose > * + h1 {
    margin-top: 6rem;
  }

  .prose > * + h2 {
    margin-top: 5rem;
  }

  .prose > * + h3 {
    margin-top: 3rem;
  }

  .prose h1 + p,
  .prose h1 + ul {
    margin-top: 2rem;
  }

  .prose h2 + p,
  .prose h2 + ul,
  .prose h2 + h3 {
    margin-top: 1.8rem;
  }

  .prose h3 + p,
  .prose h3 + ul {
    margin-top: 1.2rem;
  }

  /* åµŒå¥—åˆ—è¡¨ */
  .prose ul ul,
  .prose ol ul,
  .prose ul ol,
  .prose ol ol {
    margin-top: 1rem;
    margin-bottom: 1rem;
    padding-left: 2rem;
  }

  .prose ul ul li::before {
    content: 'â†’';
    @apply text-gray-400;
    font-size: 0.8rem;
  }

  /* å¼•ç”¨å—æ ·å¼ */
  .prose blockquote {
    @apply border-l-4 border-blue-400 bg-gradient-to-r from-blue-50 to-purple-50 pl-8 pr-6 py-6 my-8 rounded-r-xl;
    font-style: italic;
    position: relative;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }

  .prose blockquote::before {
    content: '"';
    font-size: 4rem;
    color: #93c5fd;
    position: absolute;
    top: -0.5rem;
    left: 1rem;
    font-family: serif;
    line-height: 1;
  }

  /* åˆ†éš”çº¿æ ·å¼ */
  .prose hr {
    margin: 4rem 0;
    border: none;
    height: 2px;
    background: linear-gradient(90deg, transparent, #e5e7eb, transparent);
  }

  /* æ®µè½é—´çš„é¢å¤–å‘¼å¸ç©ºé—´ */
  .prose > section,
  .prose > div {
    margin-top: 3rem;
    margin-bottom: 3rem;
  }

  /* è¡¨æ ¼æ ·å¼ä¼˜åŒ– */
  .prose table {
    @apply w-full border-collapse my-8;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }

  .prose th {
    @apply bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-4 text-left font-semibold;
  }

  .prose td {
    @apply px-6 py-4 border-b border-gray-200;
  }

  .prose tr:hover td {
    @apply bg-blue-50;
  }

  /* ç»ç’ƒæ€æ•ˆæœå¢å¼º */
  .backdrop-blur-xl {
    backdrop-filter: blur(20px);
  }

  /* æ‚¬æµ®åŠ¨ç”» */
  .hover\:scale-105:hover {
    transform: scale(1.05);
  }

  .hover\:scale-110:hover {
    transform: scale(1.1);
  }
</style>